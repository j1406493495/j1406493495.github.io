---
layout: blog 
android: true 
istop: false 
title: "Binder使用图谱" 
background-image: https://ws4.sinaimg.cn/large/006tNc79gy1fsweryx8j8j317y0schdv.jpg
date:  2018-07-02
category: Android 
tags: 
- Android 
---



## Binder图谱

![binder](https://ws4.sinaimg.cn/large/006tNc79gy1fsvv7q2c7ij31820ku777.jpg)

## transact()和onTranscat()

```java
public final boolean transact(int code, Parcel data, Parcel replay, int flag)
```

客户端通过mRemote.transact()方法传输Parcel类数据data，服务端onTransact()接收数据并处理后，返回Parcel类数据replay。

> **纠正：（上图中 MyClient 第二点）**
>
> Proxy 中的 mRemote 为传入的 IBinder，以 Service 为例
>
> ```java
> private ServiceConnection mConn = new ServiceConnection() {
>         @Override
>         public void onServiceConnected(ComponentName name, IBinder service) {
>             binder = XXX.Stub.asInterface(service);
>         }
> 
>         @Override
>         public void onServiceDisconnected(ComponentName name) {
>             binder = null;
>         }
>     };
> ```
>
> Service 即为 IBinder，Proxy 中为其添加 AIDL 中的方法，即可进行 IPC。

## 参考

http://gityuan.com/2015/10/31/binder-prepare/

![](https://ws1.sinaimg.cn/large/006tNbRwly1fwbdzvzevej31560n0gv2.jpg)

![](https://ws1.sinaimg.cn/large/006tNbRwly1fwbe0s48e2j316g0den12.jpg)













